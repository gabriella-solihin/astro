from spaceprod.utils.imports import T
from tests.utils.spark_util import spark_tests as spark

from pyspark import Row

# for this one need to specify schema explicitly
SCHEMA = T.StructType(
    [
        T.StructField("Region_Desc", T.StringType(), True),
        T.StructField("Banner", T.StringType(), True),
        T.StructField("Department", T.StringType(), True),
        T.StructField("M_Cluster", T.StringType(), True),
        T.StructField("Section_Master", T.StringType(), True),
        T.StructField("Need_State", T.StringType(), True),
        T.StructField("Cluster_NS_Sum_Opt_Facing", T.StringType(), True),
        T.StructField("Cluster_Dep_Sum_Opt_Facing", T.StringType(), True),
        T.StructField("pred_facing_pen", T.StringType(), True),
        T.StructField("section_facing_pen", T.StringType(), True),
        T.StructField("prop_ns_facings_in_section", T.StringType(), True),
        T.StructField("outlier", T.StringType(), True),
        T.StructField("_merge", T.StringType(), True),
    ]
)


DF_MARGIN_PENETRATION_PROPORTIONS = spark.createDataFrame(
    [
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="4",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.013839544377474138",
            section_facing_pen="0.18792076654908732",
            prop_ns_facings_in_section="0.07364563603916052",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.014897824810902408",
            section_facing_pen="0.18792076654908732",
            prop_ns_facings_in_section="0.0792771607123628",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="17",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.014605045356707206",
            section_facing_pen="0.18792076654908732",
            prop_ns_facings_in_section="0.07771916656636338",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="TETRA JUICE",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.013900017950592907",
            section_facing_pen="0.06731528005509367",
            prop_ns_facings_in_section="0.20649127418346244",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="3",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.012368874940398698",
            section_facing_pen="0.12500020792634098",
            prop_ns_facings_in_section="0.09895083492730924",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="5",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.011697926526356619",
            section_facing_pen="0.12500020792634098",
            prop_ns_facings_in_section="0.09358325654346007",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="9",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.012711656486284254",
            section_facing_pen="0.12500020792634098",
            prop_ns_facings_in_section="0.10169308273290927",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.013518744355623308",
            section_facing_pen="0.12500020792634098",
            prop_ns_facings_in_section="0.1081497749474906",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="7",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.010010023119143216",
            section_facing_pen="0.12500020792634098",
            prop_ns_facings_in_section="0.08008005174712857",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="POPCORN",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.012470141781737606",
            section_facing_pen="0.07885098456152476",
            prop_ns_facings_in_section="0.15814820640581317",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="RICECAKES",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.014347659859932617",
            section_facing_pen="0.05112806262362361",
            prop_ns_facings_in_section="0.28062201311151014",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="RED JUICE",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.012104284266764662",
            section_facing_pen="0.033637138851353526",
            prop_ns_facings_in_section="0.35984880641171413",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="NATURAL JUICES",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.007409684091754534",
            section_facing_pen="0.02583007985463031",
            prop_ns_facings_in_section="0.28686260876682",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="NON ALCOHOL",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.016045999675317116",
            section_facing_pen="0.04725754779453241",
            prop_ns_facings_in_section="0.3395436374541127",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CANDY",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.012496513552088716",
            section_facing_pen="0.0996225285502377",
            prop_ns_facings_in_section="0.12543863053814144",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CANDY",
            Need_State="7",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.013642599601090396",
            section_facing_pen="0.08671026056489262",
            prop_ns_facings_in_section="0.1573354700148835",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="4",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.00945205834015185",
            section_facing_pen="0.12912512323346456",
            prop_ns_facings_in_section="0.07320076917225524",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.02432115616231264",
            section_facing_pen="0.12912512323346456",
            prop_ns_facings_in_section="0.18835340136201686",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.014774656848613893",
            section_facing_pen="0.12912512323346456",
            prop_ns_facings_in_section="0.11442124103069073",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="6",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.006373780220711877",
            section_facing_pen="0.12912512323346456",
            prop_ns_facings_in_section="0.049361271153931595",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="FAMILY JUICE",
            Need_State="5",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.01194279335414797",
            section_facing_pen="0.12912512323346456",
            prop_ns_facings_in_section="0.09249008291403381",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="POPCORN",
            Need_State="7",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.007479879418043504",
            section_facing_pen="0.07124385192485522",
            prop_ns_facings_in_section="0.10498982320513695",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="POPCORN",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.02555732396011074",
            section_facing_pen="0.07124385192485522",
            prop_ns_facings_in_section="0.35873023804310084",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="RED JUICE",
            Need_State="3",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.002964497866230034",
            section_facing_pen="0.04202263165203396",
            prop_ns_facings_in_section="0.07054526929149492",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="RED JUICE",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.008705188191651987",
            section_facing_pen="0.04202263165203396",
            prop_ns_facings_in_section="0.20715476040945766",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="RED JUICE",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.020168703188494404",
            section_facing_pen="0.04202263165203396",
            prop_ns_facings_in_section="0.4799485990192194",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="RED JUICE",
            Need_State="5",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.0033350620491097434",
            section_facing_pen="0.04202263165203396",
            prop_ns_facings_in_section="0.07936347434700276",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="NATURAL JUICES",
            Need_State="3",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="8.334387304129132e-05",
            section_facing_pen="0.009878706768149238",
            prop_ns_facings_in_section="0.008436718995446575",
            outlier=None,
            _merge="left_only",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="NATURAL JUICES",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.0043239978051631545",
            section_facing_pen="0.009878706768149238",
            prop_ns_facings_in_section="0.4377088931422194",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="14",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.020985666101977576",
            section_facing_pen="0.19433499290320103",
            prop_ns_facings_in_section="0.1079870680440481",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="5",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.008639163492810176",
            section_facing_pen="0.19433499290320103",
            prop_ns_facings_in_section="0.04445500711811267",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="NON ALCOHOL",
            Need_State="5",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.011615064050149134",
            section_facing_pen="0.04299490247978054",
            prop_ns_facings_in_section="0.27014979405085093",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="RICECAKES",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.02495951918295433",
            section_facing_pen="0.042272146765214416",
            prop_ns_facings_in_section="0.5904483470305658",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="PUDDING CUPS",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.007516921075174015",
            section_facing_pen="0.019468554529868662",
            prop_ns_facings_in_section="0.3861057616599914",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="PUDDING CUPS",
            Need_State="3",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.0047537586614244225",
            section_facing_pen="0.019468554529868662",
            prop_ns_facings_in_section="0.244176251201968",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CANNED FRUIT",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.012644585173810612",
            section_facing_pen="0.09459847320904821",
            prop_ns_facings_in_section="0.13366584834691786",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="3",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.014756963800947424",
            section_facing_pen="0.21965969120170092",
            prop_ns_facings_in_section="0.06718102770797829",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.01473531181567967",
            section_facing_pen="0.21965969120170092",
            prop_ns_facings_in_section="0.06708245711840265",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="6",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.01505309203366367",
            section_facing_pen="0.21965969120170092",
            prop_ns_facings_in_section="0.06852915048415176",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="7",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.011913879286195011",
            section_facing_pen="0.21965969120170092",
            prop_ns_facings_in_section="0.05423789508679213",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="SOBEYS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Juice",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.03880138266969865",
            section_facing_pen="0.088282501695251",
            prop_ns_facings_in_section="0.43951385523305697",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Breakfast",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.13795768855343518",
            section_facing_pen="0.5049276307940451",
            prop_ns_facings_in_section="0.27322269596631904",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Juice",
            Need_State="3",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.03801349873545336",
            section_facing_pen="0.13108530634731494",
            prop_ns_facings_in_section="0.2899905397080533",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="THRIFTY FOODS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Juice",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.07843802849798039",
            section_facing_pen="0.13108530634731494",
            prop_ns_facings_in_section="0.598373919119174",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Juice",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.09344153764995768",
            section_facing_pen="0.28939849999240874",
            prop_ns_facings_in_section="0.32288190039827",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Juice",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.0930247663886549",
            section_facing_pen="0.28939849999240874",
            prop_ns_facings_in_section="0.32144177109105626",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Breakfast",
            Need_State="6",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.11642581160220973",
            section_facing_pen="0.45631291336294477",
            prop_ns_facings_in_section="0.25514467855878165",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="west",
            Banner="SOBEYS",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Dessert",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.0922733691893403",
            section_facing_pen="0.2249577055098488",
            prop_ns_facings_in_section="0.41018096704093787",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="quebec",
            Banner="IGA",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="11",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.026626011436311874",
            section_facing_pen="0.5326885261951411",
            prop_ns_facings_in_section="0.04998420301352221",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="quebec",
            Banner="IGA",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.01998797293634934",
            section_facing_pen="0.5326885261951411",
            prop_ns_facings_in_section="0.03752281484100729",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="quebec",
            Banner="IGA",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY CHOCOLATE",
            Need_State="5",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.06747527701177955",
            section_facing_pen="0.5326885261951411",
            prop_ns_facings_in_section="0.1266692892631616",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="12",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.027725317612217776",
            section_facing_pen="0.29691295565822884",
            prop_ns_facings_in_section="0.09337860502164105",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="6",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.01552386773027407",
            section_facing_pen="0.29691295565822884",
            prop_ns_facings_in_section="0.05228423830768542",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="8",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.008967252934022778",
            section_facing_pen="0.29691295565822884",
            prop_ns_facings_in_section="0.03020162227055131",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="JUICE COMBO - SS ",
            Need_State="15",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.021788027360406755",
            section_facing_pen="0.29691295565822884",
            prop_ns_facings_in_section="0.07338186813743001",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="PUDDING CUPS",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.004520277212206759",
            section_facing_pen="0.039215612854795676",
            prop_ns_facings_in_section="0.1152672847149952",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="PUDDING CUPS",
            Need_State="3",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.01112291276508947",
            section_facing_pen="0.039215612854795676",
            prop_ns_facings_in_section="0.283634806531635",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="PUDDING CUPS",
            Need_State="2",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.007641043308756146",
            section_facing_pen="0.039215612854795676",
            prop_ns_facings_in_section="0.19484696916630548",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="PUDDING CUPS",
            Need_State="4",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.008500193179906473",
            section_facing_pen="0.039215612854795676",
            prop_ns_facings_in_section="0.2167553318975349",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Impulse",
            M_Cluster="1A",
            Section_Master="CONFECTIONARY ALL SECTIONS COMBO",
            Need_State="-1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="1.871891620385039e-07",
            section_facing_pen="0.2148431723390812",
            prop_ns_facings_in_section="8.712828059672675e-07",
            outlier=None,
            _merge="left_only",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Breakfast",
            Need_State="4",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.3122860070990075",
            section_facing_pen="0.9520623050364823",
            prop_ns_facings_in_section="0.3280100529629108",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Juice",
            Need_State="1",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.020707207322164557",
            section_facing_pen="0.4223530596703595",
            prop_ns_facings_in_section="0.049028192996461856",
            outlier="1.0",
            _merge="both",
        ),
        Row(
            Region_Desc="ontario",
            Banner="FOODLAND",
            Department="Frozen",
            M_Cluster="1A",
            Section_Master="Frozen Juice",
            Need_State="4",
            Cluster_NS_Sum_Opt_Facing=None,
            Cluster_Dep_Sum_Opt_Facing=None,
            pred_facing_pen="0.06419224218004475",
            section_facing_pen="0.4223530596703595",
            prop_ns_facings_in_section="0.1519871602922585",
            outlier="1.0",
            _merge="both",
        ),
    ],
    schema=SCHEMA,
)
