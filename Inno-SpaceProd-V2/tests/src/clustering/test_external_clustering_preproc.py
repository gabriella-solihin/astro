import pandas as pd
import pytest

from pyspark import Row

from spaceprod.utils.data_transformation import is_col_null_mask
from spaceprod.utils.imports import F
from tests.utils.spark_util import spark_tests as spark
from pyspark.sql import DataFrame as SparkDataFrame
from spaceprod.src.clustering.external_clustering.preparation.helpers import (
    clean_location,
    read_format_data_header,
    preprocess_competitors,
    preprocess_demographics,
    process_store_data,
    combine_dataframe,
    final_patch_to_environics_data,
)


@pytest.fixture(scope="session")
def mock_location() -> SparkDataFrame:
    mock_location_data = spark.createDataFrame(
        [
            Row(
                RETAIL_OUTLET_LOCATION_SK="28169",
                STORE_NO="8393",
                STORE_PHYSICAL_LOCATION_NO="14727",
                POSTAL_CD="H3K1P2",
                REGION_DESC="Quebec",
                NATIONAL_BANNER_DESC="SOBEYS",
            ),
            Row(
                RETAIL_OUTLET_LOCATION_SK="28166",
                STORE_NO="8394",
                POSTAL_CD="H3K1P2",
                STORE_PHYSICAL_LOCATION_NO="14727",
                REGION_DESC="Quebec",
                NATIONAL_BANNER_DESC="SOBEYS",
            ),
            Row(
                RETAIL_OUTLET_LOCATION_SK="28146",
                STORE_NO="8074",
                POSTAL_CD="H3K1P2",
                STORE_PHYSICAL_LOCATION_NO="10590",
                REGION_DESC="Quebec",
                NATIONAL_BANNER_DESC="SOBEYS",
            ),
            Row(
                RETAIL_OUTLET_LOCATION_SK="28145",
                STORE_NO="558",
                STORE_PHYSICAL_LOCATION_NO="14750",
                POSTAL_CD="H3K1P2",
                REGION_DESC="Quebec",
                NATIONAL_BANNER_DESC="SOBEYS",
            ),
            Row(
                RETAIL_OUTLET_LOCATION_SK="28143",
                STORE_NO="8075",
                POSTAL_CD="H3K1P2",
                STORE_PHYSICAL_LOCATION_NO="10590",
                REGION_DESC="Quebec",
                NATIONAL_BANNER_DESC="SOBEYS",
            ),
        ]
    )

    return mock_location_data


@pytest.fixture(scope="session")
def mock_store_list():
    mock_store_list_data = spark.createDataFrame(
        [
            Row(
                BANNER_KEY="6000512",
                BAN_NO="8393",
                BAN_DESC="49th Parallel                 ",
                tot_wkly_sales="277000",
                tot_sales_area="15000",
                tot_gross_area="20000",
            ),
            Row(
                BANNER_KEY="6001861",
                BAN_NO="8074",
                BAN_DESC="49th Parallel                 ",
                tot_wkly_sales="305000",
                tot_sales_area="17000",
                tot_gross_area="22000",
            ),
            Row(
                BANNER_KEY="6003051",
                BAN_NO="558",
                BAN_DESC="49th Parallel                 ",
                tot_wkly_sales="200001",
                tot_sales_area="19001",
                tot_gross_area="24001",
            ),
            Row(
                BANNER_KEY="6000510",
                BAN_NO="8075",
                BAN_DESC="49th Parallel                 ",
                tot_wkly_sales="198000",
                tot_sales_area="13000",
                tot_gross_area="17000",
            ),
            Row(
                BANNER_KEY="6000769",
                BAN_NO=" ",
                BAN_DESC="49th Parallel                 ",
                tot_wkly_sales="30000",
                tot_sales_area="4000",
                tot_gross_area="6000",
            ),
        ]
    )
    return mock_store_list_data


@pytest.fixture(scope="session")
def mock_pdf_demographics_data_5_min():
    mock_pdf_demographics_data_5_min_data = spark.sparkContext.parallelize(
        [
            Row(
                "1001160",
                "Sobeys Grimsby                ",
                "642",
                "7989",
                "2296",
                "4325",
                "7989",
                "427",
                "435",
                "454",
                "445",
                "434",
                "487",
                "485",
                "522",
                "495",
                "489",
                "530",
                "606",
                "541",
                "469",
                "448",
                "331",
                "195",
                "197",
                "42.614",
                "3419",
                "2.324",
                "2436",
                "0.712",
                "105",
                "522",
                "463",
                "460",
                "410",
                "1460",
                "386",
                "313",
                "380",
                "381",
                "269",
                "112",
                "106833.293",
                "87425.137",
                "6589",
                "917",
                "1813",
                "447",
                "1693",
                "70",
                "1650",
                "1245",
                "405",
                "7905",
                "541",
                "63",
                "138",
                "74",
                "38",
                "53",
                "40",
                "20",
                "5",
                "13",
                "25",
                "32",
                "40",
                "7363",
                "3171",
                "6666",
                "6072",
                "595",
                "1212",
                "159",
                "65",
                "65",
                "0",
                "8",
                "2",
                "5",
                "1",
                "50",
                "9",
                "0",
                "20",
                "3",
                "18",
                "35",
                "4",
                "5",
                "11",
                "6",
                "3",
                "2",
                "5",
                "845",
                "179",
                "0",
                "47",
                "132",
                "0",
                "162",
                "2",
                "11",
                "1",
                "112",
                "11",
                "10",
                "15",
                "0",
                "338",
                "305",
                "14",
                "18",
                "166",
                "14",
                "61",
                "23",
                "24",
                "23",
                "18",
                "3",
                "28",
                "4",
                "0",
                "0",
                "0",
                "4",
                "9",
                "1",
                "0",
                "5",
                "0",
                "0",
                "2",
                "2",
                "0",
                "0",
                "2",
                "5",
                "0",
                "4",
                "0",
                "0",
                "1",
                "8",
                "8",
                "0",
                "162",
                "29",
                "3",
                "2",
                "3",
                "0",
                "12",
                "0",
                "4",
                "1",
                "0",
                "3",
                "39",
                "27",
                "1",
                "11",
                "0",
                "0",
                "0",
                "60",
                "0",
                "0",
                "20",
                "21",
                "19",
                "34",
                "3",
                "26",
                "1",
                "0",
                "5",
                "0",
                "19",
                "17",
                "0",
                "1",
                "26",
            ),
            Row(
                "1001954",
                "Sobeys Cambridge              ",
                "678",
                "16814",
                "4575",
                "9331",
                "16814",
                "826",
                "885",
                "773",
                "846",
                "1061",
                "1325",
                "1257",
                "1186",
                "1067",
                "993",
                "1152",
                "1226",
                "1155",
                "1004",
                "771",
                "516",
                "365",
                "405",
                "41.888",
                "7012",
                "2.358",
                "4809",
                "0.686",
                "481",
                "1337",
                "1001",
                "854",
                "717",
                "2622",
                "706",
                "529",
                "632",
                "755",
                "475",
                "280",
                "101886.206",
                "75817.966",
                "13969",
                "2386",
                "4393",
                "933",
                "3512",
                "138",
                "2606",
                "1909",
                "697",
                "16452",
                "1456",
                "174",
                "439",
                "326",
                "85",
                "143",
                "50",
                "74",
                "72",
                "4",
                "14",
                "45",
                "31",
                "14997",
                "2121",
                "14003",
                "12226",
                "1777",
                "2395",
                "293",
                "117",
                "117",
                "0",
                "48",
                "8",
                "7",
                "33",
                "57",
                "4",
                "1",
                "37",
                "6",
                "9",
                "71",
                "8",
                "4",
                "14",
                "23",
                "0",
                "2",
                "20",
                "1459",
                "157",
                "1",
                "56",
                "68",
                "32",
                "168",
                "12",
                "24",
                "1",
                "63",
                "23",
                "9",
                "7",
                "30",
                "768",
                "749",
                "7",
                "13",
                "366",
                "6",
                "66",
                "239",
                "7",
                "0",
                "27",
                "21",
                "163",
                "7",
                "0",
                "1",
                "1",
                "5",
                "112",
                "10",
                "13",
                "21",
                "1",
                "8",
                "59",
                "1",
                "0",
                "0",
                "1",
                "30",
                "8",
                "14",
                "1",
                "0",
                "7",
                "13",
                "13",
                "0",
                "476",
                "113",
                "37",
                "16",
                "15",
                "3",
                "1",
                "4",
                "10",
                "5",
                "0",
                "22",
                "38",
                "22",
                "8",
                "1",
                "8",
                "0",
                "0",
                "112",
                "0",
                "0",
                "82",
                "27",
                "4",
                "212",
                "21",
                "90",
                "0",
                "82",
                "19",
                "1",
                "4",
                "3",
                "0",
                "2",
                "54",
            ),
            Row(
                "1003570",
                "Sobeys Simcoe                 ",
                "664",
                "7430",
                "2075",
                "3455",
                "7430",
                "338",
                "368",
                "342",
                "364",
                "402",
                "424",
                "465",
                "431",
                "379",
                "410",
                "462",
                "557",
                "597",
                "571",
                "487",
                "369",
                "235",
                "230",
                "45.453",
                "3423",
                "2.151",
                "1815",
                "0.53",
                "183",
                "890",
                "623",
                "454",
                "359",
                "915",
                "327",
                "225",
                "201",
                "162",
                "124",
                "38",
                "77988.916",
                "60609.263",
                "6213",
                "1225",
                "1939",
                "548",
                "1636",
                "64",
                "800",
                "582",
                "218",
                "7259",
                "278",
                "44",
                "3",
                "165",
                "25",
                "25",
                "0",
                "0",
                "2",
                "9",
                "0",
                "6",
                "0",
                "6981",
                "9406",
                "6518",
                "5986",
                "531",
                "700",
                "123",
                "40",
                "39",
                "1",
                "9",
                "4",
                "5",
                "1",
                "57",
                "0",
                "1",
                "27",
                "3",
                "26",
                "17",
                "0",
                "0",
                "17",
                "0",
                "0",
                "0",
                "0",
                "490",
                "125",
                "2",
                "31",
                "60",
                "33",
                "45",
                "2",
                "18",
                "0",
                "17",
                "2",
                "0",
                "2",
                "4",
                "140",
                "125",
                "0",
                "15",
                "179",
                "3",
                "29",
                "130",
                "0",
                "4",
                "13",
                "0",
                "16",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "13",
                "0",
                "0",
                "13",
                "1",
                "0",
                "1",
                "0",
                "0",
                "0",
                "2",
                "2",
                "0",
                "64",
                "5",
                "0",
                "4",
                "0",
                "1",
                "0",
                "0",
                "0",
                "0",
                "1",
                "0",
                "39",
                "33",
                "0",
                "0",
                "5",
                "0",
                "0",
                "18",
                "0",
                "0",
                "17",
                "0",
                "1",
                "2",
                "0",
                "2",
                "0",
                "0",
                "0",
                "0",
                "7",
                "2",
                "0",
                "5",
                "42",
            ),
            Row(
                "1005168",
                "Sobeys Highway 400 Barrie     ",
                "712",
                "3",
                "1",
                "2",
                "3",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "1",
                "3",
                "1",
                "1",
                "0",
                "0",
                "0",
                "0",
                "0",
                "1",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "113937.15",
                "113937.15",
                "2",
                "0",
                "1",
                "0",
                "1",
                "0",
                "0",
                "0",
                "0",
                "3",
                "1",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "2",
                "7234",
                "3",
                "2",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
            ),
            Row(
                "1009301",
                "Sobeys Bridgeport             ",
                "649",
                "18102",
                "4108",
                "10080",
                "18102",
                "625",
                "587",
                "520",
                "769",
                "2716",
                "2458",
                "1690",
                "1184",
                "897",
                "812",
                "818",
                "916",
                "953",
                "809",
                "744",
                "622",
                "484",
                "498",
                "40.152",
                "8852",
                "2.027",
                "3211",
                "0.363",
                "658",
                "2043",
                "1394",
                "1107",
                "940",
                "2711",
                "846",
                "575",
                "630",
                "659",
                "413",
                "246",
                "87567.679",
                "65541.831",
                "16236",
                "1664",
                "4706",
                "742",
                "2427",
                "206",
                "6491",
                "4315",
                "2176",
                "17964",
                "4270",
                "1536",
                "1030",
                "343",
                "77",
                "301",
                "191",
                "279",
                "146",
                "139",
                "11",
                "60",
                "156",
                "13694",
                "6331",
                "12675",
                "11258",
                "1417",
                "3326",
                "468",
                "151",
                "142",
                "9",
                "67",
                "44",
                "5",
                "18",
                "108",
                "10",
                "0",
                "50",
                "34",
                "15",
                "141",
                "29",
                "7",
                "49",
                "37",
                "5",
                "8",
                "6",
                "1426",
                "371",
                "30",
                "256",
                "32",
                "52",
                "386",
                "32",
                "34",
                "7",
                "100",
                "79",
                "32",
                "60",
                "40",
                "372",
                "335",
                "6",
                "30",
                "298",
                "14",
                "16",
                "73",
                "36",
                "57",
                "62",
                "41",
                "162",
                "25",
                "3",
                "1",
                "18",
                "3",
                "70",
                "17",
                "5",
                "9",
                "6",
                "3",
                "30",
                "0",
                "0",
                "0",
                "0",
                "34",
                "1",
                "25",
                "0",
                "0",
                "9",
                "33",
                "33",
                "0",
                "1253",
                "363",
                "14",
                "92",
                "23",
                "0",
                "8",
                "9",
                "115",
                "23",
                "21",
                "57",
                "381",
                "269",
                "27",
                "4",
                "71",
                "8",
                "1",
                "166",
                "4",
                "0",
                "51",
                "31",
                "79",
                "343",
                "27",
                "193",
                "5",
                "93",
                "25",
                "0",
                "18",
                "5",
                "0",
                "13",
                "1963",
            ),
        ]
    ).toDF(
        [
            "Banner Key",
            "BAN_NAME",
            "BAN_NO",
            "2021 Total Population3",
            "2021 Total Census Family Households",
            "2021 In The Labour Force",
            "2021 Total Population6",
            "2021 Total Population 0 to 4",
            "2021 Total Population 5 to 9",
            "2021 Total Population 10 to 14",
            "2021 Total Population 15 to 19",
            "2021 Total Population 20 to 24",
            "2021 Total Population 25 to 29",
            "2021 Total Population 30 to 34",
            "2021 Total Population 35 to 39",
            "2021 Total Population 40 to 44",
            "2021 Total Population 45 to 49",
            "2021 Total Population 50 to 54",
            "2021 Total Population 55 to 59",
            "2021 Total Population 60 to 64",
            "2021 Total Population 65 to 69",
            "2021 Total Population 70 to 74",
            "2021 Total Population 75 to 79",
            "2021 Total Population 80 to 84",
            "2021 Total Population 85 or Older",
            "2021 Average Age of Total Population",
            "2021 Total Households for Household Size",
            "2021 Household Size - Average Number of Persons In Private Households",
            "2021 Total Number of Children at Home",
            "2021 Average Children Per Household",
            "2021 Household Income $0 To $19,999 (Current Year $)",
            "2021 Household Income $20,000 To $39,999 (Current Year $)",
            "2021 Household Income $40,000 To $59,999 (Current Year $)",
            "2021 Household Income $60,000 To $79,999 (Current Year $)",
            "2021 Household Income $80,000 To $99,999 (Current Year $)",
            "2021 Household Income $100,000 Or Over (Current Year $)",
            "2021 Household Income $100,000 To $124,999 (Current Year $)",
            "2021 Household Income $125,000 To $149,999 (Current Year $)",
            "2021 Household Income $150,000 To $199,999 (Current Year $)",
            "2021 Household Income $200,000 Or Over (Current Year $)",
            "2021 Household Income $200,000 To $299,999 (Current Year $)",
            "2021 Household Income $300,000 Or Over (Current Year $)",
            "2021 Average Household Income (Current Year $)",
            "2021 Median Household Income (Current Year $)",
            "2021 Household Population 15 Years or Over for Educational Attainment",
            "2021 Household Population 15 Years or Over for Educational Attainment - No certificate, diploma or degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - High school certificate or equivalent",
            "2021 Household Population 15 Years or Over for Educational Attainment - Apprenticeship or trades certificate or diploma",
            "2021 Household Population 15 Years or Over for Educational Attainment - College, CEGEP or other non-university certificate or diploma",
            "2021 Household Population 15 Years or Over for Educational Attainment - University certificate or diploma below bachelor",
            "2021 Household Population 15 Years or Over for Educational Attainment - University degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - Bachelors degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - Above Bachelors",
            "2021 Household Population For Visible Minority",
            "2021 Total Visible Minorities",
            "2021 Total Visible Minorities - Chinese",
            "2021 Total Visible Minorities - South Asian",
            "2021 Total Visible Minorities - Black",
            "2021 Total Visible Minorities - Filipino",
            "2021 Total Visible Minorities - Latin American",
            "2021 Total Visible Minorities - Southeast Asian",
            "2021 Total Visible Minorities - Arab",
            "2021 Total Visible Minorities - West Asian",
            "2021 Total Visible Minorities - Korean",
            "2021 Total Visible Minorities - Japanese",
            "2021 All Other Visible Minorities",
            "2021 Multiple Visible Minorities",
            "2021 Not a Visible Minority",
            "2021 Household Population for Total Immigration by Place of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant in Province of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant outside Province of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Total Immigrant",
            "2021 Household Population for Total Immigration by Place of Birth - Americas",
            "2021 Household Population for Total Immigration by Place of Birth - North America",
            "2021 Household Population for Total Immigration by Place of Birth - United States",
            "2021 Household Population for Total Immigration by Place of Birth - Other North America",
            "2021 Household Population for Total Immigration by Place of Birth - Central America",
            "2021 Household Population for Total Immigration by Place of Birth - El Salvador",
            "2021 Household Population for Total Immigration by Place of Birth - Mexico",
            "2021 Household Population for Total Immigration by Place of Birth - Other Central America",
            "2021 Household Population for Total Immigration by Place of Birth - Caribbean and Bermuda",
            "2021 Household Population for Total Immigration by Place of Birth - Cuba",
            "2021 Household Population for Total Immigration by Place of Birth - Haiti",
            "2021 Household Population for Total Immigration by Place of Birth - Jamaica",
            "2021 Household Population for Total Immigration by Place of Birth - Trinidad and Tobago",
            "2021 Household Population for Total Immigration by Place of Birth - Other Caribbean and Bermuda",
            "2021 Household Population for Total Immigration by Place of Birth - South America",
            "2021 Household Population for Total Immigration by Place of Birth - Brazil",
            "2021 Household Population for Total Immigration by Place of Birth - Chile",
            "2021 Household Population for Total Immigration by Place of Birth - Colombia",
            "2021 Household Population for Total Immigration by Place of Birth - Guyana",
            "2021 Household Population for Total Immigration by Place of Birth - Peru",
            "2021 Household Population for Total Immigration by Place of Birth - Venezuela",
            "2021 Household Population for Total Immigration by Place of Birth - Other South America",
            "2021 Household Population for Total Immigration by Place of Birth - Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Western Europe",
            "2021 Household Population for Total Immigration by Place of Birth - France",
            "2021 Household Population for Total Immigration by Place of Birth - Germany",
            "2021 Household Population for Total Immigration by Place of Birth - Netherlands",
            "2021 Household Population for Total Immigration by Place of Birth - Other Western Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Czech Republic",
            "2021 Household Population for Total Immigration by Place of Birth - Hungary",
            "2021 Household Population for Total Immigration by Place of Birth - Moldova",
            "2021 Household Population for Total Immigration by Place of Birth - Poland",
            "2021 Household Population for Total Immigration by Place of Birth - Romania",
            "2021 Household Population for Total Immigration by Place of Birth - Russia",
            "2021 Household Population for Total Immigration by Place of Birth - Ukraine",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Northern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - United Kingdom",
            "2021 Household Population for Total Immigration by Place of Birth - Ireland",
            "2021 Household Population for Total Immigration by Place of Birth - Other Northern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Greece",
            "2021 Household Population for Total Immigration by Place of Birth - Italy",
            "2021 Household Population for Total Immigration by Place of Birth - Portugal",
            "2021 Household Population for Total Immigration by Place of Birth - Bosnia Herzegovina",
            "2021 Household Population for Total Immigration by Place of Birth - Croatia",
            "2021 Household Population for Total Immigration by Place of Birth - Serbia",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Western Africa",
            "2021 Household Population for Total Immigration by Place of Birth - CÃ´te dIvoire",
            "2021 Household Population for Total Immigration by Place of Birth - Ghana",
            "2021 Household Population for Total Immigration by Place of Birth - Nigeria",
            "2021 Household Population for Total Immigration by Place of Birth - Other Western Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Eritrea",
            "2021 Household Population for Total Immigration by Place of Birth - Ethiopia",
            "2021 Household Population for Total Immigration by Place of Birth - Kenya",
            "2021 Household Population for Total Immigration by Place of Birth - Somalia",
            "2021 Household Population for Total Immigration by Place of Birth - Tanzania",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Central Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Cameroon",
            "2021 Household Population for Total Immigration by Place of Birth - Congo, The Democratic Republic of The",
            "2021 Household Population for Total Immigration by Place of Birth - Other Central Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Northern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Algeria",
            "2021 Household Population for Total Immigration by Place of Birth - Egypt",
            "2021 Household Population for Total Immigration by Place of Birth - Morocco",
            "2021 Household Population for Total Immigration by Place of Birth - Tunisia",
            "2021 Household Population for Total Immigration by Place of Birth - Other Northern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - South Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Asia",
            "2021 Household Population for Total Immigration by Place of Birth - West Central Asia and Middle East",
            "2021 Household Population for Total Immigration by Place of Birth - Afghanistan",
            "2021 Household Population for Total Immigration by Place of Birth - Iran",
            "2021 Household Population for Total Immigration by Place of Birth - Iraq",
            "2021 Household Population for Total Immigration by Place of Birth - Israel",
            "2021 Household Population for Total Immigration by Place of Birth - Lebanon",
            "2021 Household Population for Total Immigration by Place of Birth - Saudi Arabia",
            "2021 Household Population for Total Immigration by Place of Birth - Syria",
            "2021 Household Population for Total Immigration by Place of Birth - Turkey",
            "2021 Household Population for Total Immigration by Place of Birth - United Arab Emirates",
            "2021 Household Population for Total Immigration by Place of Birth - Other West Central Asia and Middle East",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - China",
            "2021 Household Population for Total Immigration by Place of Birth - Hong Kong",
            "2021 Household Population for Total Immigration by Place of Birth - Japan",
            "2021 Household Population for Total Immigration by Place of Birth - South Korea",
            "2021 Household Population for Total Immigration by Place of Birth - Taiwan",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Southeastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Cambodia",
            "2021 Household Population for Total Immigration by Place of Birth - Malaysia",
            "2021 Household Population for Total Immigration by Place of Birth - Philippines",
            "2021 Household Population for Total Immigration by Place of Birth - Vietnam",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southeastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Bangladesh",
            "2021 Household Population for Total Immigration by Place of Birth - India",
            "2021 Household Population for Total Immigration by Place of Birth - Nepal",
            "2021 Household Population for Total Immigration by Place of Birth - Pakistan",
            "2021 Household Population for Total Immigration by Place of Birth - Sri Lanka",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Oceania and Other",
            "2021 Household Population for Total Immigration by Place of Birth - Australia",
            "2021 Household Population for Total Immigration by Place of Birth - Fiji",
            "2021 Household Population for Total Immigration by Place of Birth - Other Oceania and Other",
            "2021 Household Population for Total Immigration by Place of Birth - Non-permanent residents",
        ]
    )

    return mock_pdf_demographics_data_5_min_data


@pytest.fixture(scope="session")
def mock_pdf_demographics_data_10_min():
    mock_pdf_demographics_data_10_min_data = spark.sparkContext.parallelize(
        [
            Row(
                "1001160",
                "Farm Boy Bronte               ",
                "4731",
                "56571",
                "15862",
                "30135",
                "56571",
                "2302",
                "2792",
                "3249",
                "3685",
                "3450",
                "2903",
                "2456",
                "2784",
                "3567",
                "4060",
                "4352",
                "4369",
                "3804",
                "3088",
                "2907",
                "2442",
                "1978",
                "2382",
                "44.528",
                "21114",
                "2.627",
                "17756",
                "0.841",
                "421",
                "2245",
                "2073",
                "2006",
                "1967",
                "12402",
                "2132",
                "1914",
                "2654",
                "5701",
                "2888",
                "2813",
                "159551.44",
                "121444.143",
                "47072",
                "4814",
                "12181",
                "2134",
                "9853",
                "939",
                "17151",
                "11756",
                "5396",
                "55415",
                "12335",
                "2098",
                "3486",
                "1575",
                "1036",
                "752",
                "329",
                "1243",
                "467",
                "408",
                "170",
                "282",
                "488",
                "43080",
                "55415",
                "38402",
                "32412",
                "5991",
                "16259",
                "1977",
                "653",
                "648",
                "4",
                "147",
                "22",
                "98",
                "28",
                "506",
                "33",
                "0",
                "214",
                "154",
                "105",
                "671",
                "148",
                "56",
                "118",
                "41",
                "62",
                "136",
                "110",
                "7655",
                "846",
                "92",
                "393",
                "251",
                "109",
                "1713",
                "87",
                "148",
                "21",
                "550",
                "228",
                "172",
                "223",
                "284",
                "3446",
                "3091",
                "263",
                "91",
                "1651",
                "59",
                "359",
                "489",
                "96",
                "213",
                "188",
                "248",
                "1290",
                "136",
                "2",
                "39",
                "85",
                "10",
                "178",
                "9",
                "7",
                "51",
                "4",
                "16",
                "91",
                "9",
                "3",
                "3",
                "3",
                "611",
                "6",
                "556",
                "18",
                "3",
                "28",
                "356",
                "347",
                "8",
                "5216",
                "1074",
                "84",
                "240",
                "145",
                "36",
                "79",
                "40",
                "44",
                "114",
                "57",
                "235",
                "1466",
                "974",
                "97",
                "56",
                "239",
                "99",
                "1",
                "1130",
                "6",
                "30",
                "829",
                "167",
                "98",
                "1546",
                "14",
                "1110",
                "0",
                "306",
                "115",
                "0",
                "120",
                "78",
                "12",
                "29",
                "753",
            ),
            Row(
                "1001954",
                "Sobeys March Road Kanata      ",
                "4755",
                "45081",
                "12052",
                "24537",
                "45081",
                "2405",
                "3014",
                "3513",
                "3244",
                "2751",
                "2483",
                "2512",
                "2927",
                "3394",
                "3590",
                "3262",
                "3032",
                "2365",
                "1872",
                "1673",
                "1272",
                "907",
                "864",
                "38.975",
                "15158",
                "2.926",
                "15781",
                "1.041",
                "196",
                "1053",
                "1055",
                "1298",
                "1504",
                "10054",
                "1830",
                "1747",
                "2337",
                "4140",
                "2428",
                "1712",
                "160221.583",
                "133880.201",
                "35619",
                "3349",
                "7285",
                "877",
                "6725",
                "521",
                "16863",
                "10435",
                "6428",
                "44540",
                "17686",
                "6068",
                "4257",
                "1651",
                "566",
                "425",
                "1093",
                "1858",
                "780",
                "280",
                "134",
                "92",
                "482",
                "26854",
                "44540",
                "29424",
                "22631",
                "6792",
                "14360",
                "1257",
                "444",
                "443",
                "1",
                "154",
                "49",
                "47",
                "58",
                "340",
                "55",
                "102",
                "58",
                "77",
                "47",
                "320",
                "149",
                "5",
                "38",
                "24",
                "24",
                "26",
                "53",
                "2937",
                "349",
                "93",
                "142",
                "80",
                "34",
                "1220",
                "19",
                "15",
                "25",
                "227",
                "262",
                "322",
                "182",
                "167",
                "1084",
                "962",
                "44",
                "79",
                "285",
                "15",
                "40",
                "28",
                "84",
                "16",
                "48",
                "54",
                "1245",
                "168",
                "8",
                "16",
                "95",
                "49",
                "370",
                "47",
                "76",
                "41",
                "60",
                "27",
                "119",
                "145",
                "79",
                "61",
                "6",
                "531",
                "103",
                "368",
                "14",
                "13",
                "34",
                "30",
                "30",
                "0",
                "8894",
                "1621",
                "149",
                "336",
                "96",
                "99",
                "227",
                "52",
                "309",
                "143",
                "33",
                "177",
                "3658",
                "3089",
                "285",
                "52",
                "145",
                "66",
                "21",
                "1377",
                "223",
                "64",
                "466",
                "494",
                "131",
                "2239",
                "191",
                "1340",
                "13",
                "366",
                "328",
                "0",
                "27",
                "19",
                "7",
                "1",
                "756",
            ),
            Row(
                "1003570",
                "IGA Rigaud #8071              ",
                "8071",
                "9248",
                "2606",
                "5238",
                "9248",
                "391",
                "469",
                "490",
                "489",
                "459",
                "465",
                "463",
                "488",
                "586",
                "626",
                "690",
                "798",
                "770",
                "664",
                "558",
                "371",
                "221",
                "251",
                "44.887",
                "3757",
                "2.402",
                "2520",
                "0.671",
                "123",
                "692",
                "545",
                "527",
                "466",
                "1404",
                "440",
                "338",
                "301",
                "325",
                "211",
                "114",
                "97878.984",
                "79661.447",
                "7740",
                "1302",
                "2142",
                "1253",
                "1406",
                "173",
                "1465",
                "1095",
                "370",
                "9090",
                "463",
                "38",
                "20",
                "192",
                "8",
                "93",
                "38",
                "42",
                "19",
                "0",
                "0",
                "1",
                "15",
                "8627",
                "9090",
                "8201",
                "7193",
                "1008",
                "844",
                "177",
                "50",
                "50",
                "0",
                "28",
                "8",
                "11",
                "9",
                "35",
                "0",
                "13",
                "1",
                "0",
                "20",
                "64",
                "1",
                "26",
                "16",
                "1",
                "9",
                "9",
                "2",
                "429",
                "171",
                "87",
                "36",
                "19",
                "30",
                "117",
                "2",
                "10",
                "3",
                "74",
                "7",
                "14",
                "1",
                "5",
                "85",
                "82",
                "0",
                "2",
                "56",
                "11",
                "19",
                "8",
                "0",
                "3",
                "14",
                "0",
                "79",
                "11",
                "1",
                "9",
                "0",
                "1",
                "25",
                "0",
                "0",
                "5",
                "2",
                "1",
                "16",
                "0",
                "0",
                "0",
                "0",
                "33",
                "17",
                "7",
                "5",
                "4",
                "0",
                "11",
                "11",
                "0",
                "152",
                "60",
                "1",
                "23",
                "0",
                "0",
                "34",
                "0",
                "0",
                "1",
                "0",
                "1",
                "33",
                "22",
                "6",
                "1",
                "0",
                "4",
                "0",
                "46",
                "8",
                "0",
                "18",
                "5",
                "16",
                "13",
                "1",
                "9",
                "0",
                "2",
                "0",
                "0",
                "7",
                "0",
                "0",
                "7",
                "45",
            ),
            Row(
                "1005168",
                "Bonichoix St-Tite-Caps #6124  ",
                "6124",
                "1421",
                "443",
                "646",
                "1421",
                "70",
                "69",
                "71",
                "51",
                "39",
                "54",
                "61",
                "69",
                "85",
                "99",
                "106",
                "127",
                "145",
                "124",
                "111",
                "68",
                "37",
                "30",
                "47.192",
                "676",
                "2.084",
                "343",
                "0.507",
                "29",
                "171",
                "127",
                "84",
                "69",
                "195",
                "69",
                "45",
                "46",
                "35",
                "27",
                "8",
                "81073.836",
                "62119.222",
                "1203",
                "369",
                "296",
                "291",
                "162",
                "10",
                "74",
                "68",
                "6",
                "1414",
                "7",
                "0",
                "0",
                "7",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "1407",
                "1414",
                "1384",
                "1375",
                "9",
                "30",
                "2",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "2",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "2",
                "25",
                "24",
                "10",
                "4",
                "0",
                "10",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "1",
                "0",
                "1",
                "0",
                "0",
                "0",
                "0",
                "0",
                "3",
                "3",
                "0",
                "0",
                "0",
                "3",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
            ),
            Row(
                "1009301",
                "Foodland Deer Lake            ",
                "9218",
                "5447",
                "1792",
                "2419",
                "5447",
                "203",
                "265",
                "291",
                "291",
                "245",
                "247",
                "255",
                "265",
                "309",
                "339",
                "384",
                "436",
                "458",
                "457",
                "409",
                "284",
                "172",
                "136",
                "46.567",
                "2387",
                "2.252",
                "1524",
                "0.638",
                "191",
                "604",
                "329",
                "308",
                "245",
                "711",
                "251",
                "170",
                "196",
                "93",
                "79",
                "14",
                "79648.149",
                "64320.588",
                "4614",
                "1103",
                "1284",
                "638",
                "1055",
                "94",
                "442",
                "335",
                "106",
                "5373",
                "114",
                "16",
                "41",
                "42",
                "15",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "5258",
                "5373",
                "5276",
                "4775",
                "501",
                "42",
                "6",
                "5",
                "5",
                "0",
                "0",
                "0",
                "0",
                "0",
                "1",
                "0",
                "0",
                "1",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "16",
                "1",
                "0",
                "0",
                "1",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "15",
                "14",
                "0",
                "1",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "20",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "7",
                "7",
                "0",
                "0",
                "0",
                "0",
                "0",
                "8",
                "0",
                "0",
                "8",
                "0",
                "0",
                "5",
                "0",
                "5",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "55",
            ),
        ]
    ).toDF(
        [
            "Banner Key",
            "BAN_NAME",
            "BAN_NO",
            "2021 Total Population3",
            "2021 Total Census Family Households",
            "2021 In The Labour Force",
            "2021 Total Population6",
            "2021 Total Population 0 to 4",
            "2021 Total Population 5 to 9",
            "2021 Total Population 10 to 14",
            "2021 Total Population 15 to 19",
            "2021 Total Population 20 to 24",
            "2021 Total Population 25 to 29",
            "2021 Total Population 30 to 34",
            "2021 Total Population 35 to 39",
            "2021 Total Population 40 to 44",
            "2021 Total Population 45 to 49",
            "2021 Total Population 50 to 54",
            "2021 Total Population 55 to 59",
            "2021 Total Population 60 to 64",
            "2021 Total Population 65 to 69",
            "2021 Total Population 70 to 74",
            "2021 Total Population 75 to 79",
            "2021 Total Population 80 to 84",
            "2021 Total Population 85 or Older",
            "2021 Average Age of Total Population",
            "2021 Total Households for Household Size",
            "2021 Household Size - Average Number of Persons In Private Households",
            "2021 Total Number of Children at Home",
            "2021 Average Children Per Household",
            "2021 Household Income $0 To $19,999 (Current Year $)",
            "2021 Household Income $20,000 To $39,999 (Current Year $)",
            "2021 Household Income $40,000 To $59,999 (Current Year $)",
            "2021 Household Income $60,000 To $79,999 (Current Year $)",
            "2021 Household Income $80,000 To $99,999 (Current Year $)",
            "2021 Household Income $100,000 Or Over (Current Year $)",
            "2021 Household Income $100,000 To $124,999 (Current Year $)",
            "2021 Household Income $125,000 To $149,999 (Current Year $)",
            "2021 Household Income $150,000 To $199,999 (Current Year $)",
            "2021 Household Income $200,000 Or Over (Current Year $)",
            "2021 Household Income $200,000 To $299,999 (Current Year $)",
            "2021 Household Income $300,000 Or Over (Current Year $)",
            "2021 Average Household Income (Current Year $)",
            "2021 Median Household Income (Current Year $)",
            "2021 Household Population 15 Years or Over for Educational Attainment",
            "2021 Household Population 15 Years or Over for Educational Attainment - No certificate, diploma or degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - High school certificate or equivalent",
            "2021 Household Population 15 Years or Over for Educational Attainment - Apprenticeship or trades certificate or diploma",
            "2021 Household Population 15 Years or Over for Educational Attainment - College, CEGEP or other non-university certificate or diploma",
            "2021 Household Population 15 Years or Over for Educational Attainment - University certificate or diploma below bachelor",
            "2021 Household Population 15 Years or Over for Educational Attainment - University degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - Bachelors degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - Above Bachelors",
            "2021 Household Population For Visible Minority",
            "2021 Total Visible Minorities",
            "2021 Total Visible Minorities - Chinese",
            "2021 Total Visible Minorities - South Asian",
            "2021 Total Visible Minorities - Black",
            "2021 Total Visible Minorities - Filipino",
            "2021 Total Visible Minorities - Latin American",
            "2021 Total Visible Minorities - Southeast Asian",
            "2021 Total Visible Minorities - Arab",
            "2021 Total Visible Minorities - West Asian",
            "2021 Total Visible Minorities - Korean",
            "2021 Total Visible Minorities - Japanese",
            "2021 All Other Visible Minorities",
            "2021 Multiple Visible Minorities",
            "2021 Not a Visible Minority",
            "2021 Household Population for Total Immigration by Place of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant in Province of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant outside Province of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Total Immigrant",
            "2021 Household Population for Total Immigration by Place of Birth - Americas",
            "2021 Household Population for Total Immigration by Place of Birth - North America",
            "2021 Household Population for Total Immigration by Place of Birth - United States",
            "2021 Household Population for Total Immigration by Place of Birth - Other North America",
            "2021 Household Population for Total Immigration by Place of Birth - Central America",
            "2021 Household Population for Total Immigration by Place of Birth - El Salvador",
            "2021 Household Population for Total Immigration by Place of Birth - Mexico",
            "2021 Household Population for Total Immigration by Place of Birth - Other Central America",
            "2021 Household Population for Total Immigration by Place of Birth - Caribbean and Bermuda",
            "2021 Household Population for Total Immigration by Place of Birth - Cuba",
            "2021 Household Population for Total Immigration by Place of Birth - Haiti",
            "2021 Household Population for Total Immigration by Place of Birth - Jamaica",
            "2021 Household Population for Total Immigration by Place of Birth - Trinidad and Tobago",
            "2021 Household Population for Total Immigration by Place of Birth - Other Caribbean and Bermuda",
            "2021 Household Population for Total Immigration by Place of Birth - South America",
            "2021 Household Population for Total Immigration by Place of Birth - Brazil",
            "2021 Household Population for Total Immigration by Place of Birth - Chile",
            "2021 Household Population for Total Immigration by Place of Birth - Colombia",
            "2021 Household Population for Total Immigration by Place of Birth - Guyana",
            "2021 Household Population for Total Immigration by Place of Birth - Peru",
            "2021 Household Population for Total Immigration by Place of Birth - Venezuela",
            "2021 Household Population for Total Immigration by Place of Birth - Other South America",
            "2021 Household Population for Total Immigration by Place of Birth - Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Western Europe",
            "2021 Household Population for Total Immigration by Place of Birth - France",
            "2021 Household Population for Total Immigration by Place of Birth - Germany",
            "2021 Household Population for Total Immigration by Place of Birth - Netherlands",
            "2021 Household Population for Total Immigration by Place of Birth - Other Western Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Czech Republic",
            "2021 Household Population for Total Immigration by Place of Birth - Hungary",
            "2021 Household Population for Total Immigration by Place of Birth - Moldova",
            "2021 Household Population for Total Immigration by Place of Birth - Poland",
            "2021 Household Population for Total Immigration by Place of Birth - Romania",
            "2021 Household Population for Total Immigration by Place of Birth - Russia",
            "2021 Household Population for Total Immigration by Place of Birth - Ukraine",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Northern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - United Kingdom",
            "2021 Household Population for Total Immigration by Place of Birth - Ireland",
            "2021 Household Population for Total Immigration by Place of Birth - Other Northern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Greece",
            "2021 Household Population for Total Immigration by Place of Birth - Italy",
            "2021 Household Population for Total Immigration by Place of Birth - Portugal",
            "2021 Household Population for Total Immigration by Place of Birth - Bosnia Herzegovina",
            "2021 Household Population for Total Immigration by Place of Birth - Croatia",
            "2021 Household Population for Total Immigration by Place of Birth - Serbia",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Western Africa",
            "2021 Household Population for Total Immigration by Place of Birth - CÃ´te dIvoire",
            "2021 Household Population for Total Immigration by Place of Birth - Ghana",
            "2021 Household Population for Total Immigration by Place of Birth - Nigeria",
            "2021 Household Population for Total Immigration by Place of Birth - Other Western Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Eritrea",
            "2021 Household Population for Total Immigration by Place of Birth - Ethiopia",
            "2021 Household Population for Total Immigration by Place of Birth - Kenya",
            "2021 Household Population for Total Immigration by Place of Birth - Somalia",
            "2021 Household Population for Total Immigration by Place of Birth - Tanzania",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Central Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Cameroon",
            "2021 Household Population for Total Immigration by Place of Birth - Congo, The Democratic Republic of The",
            "2021 Household Population for Total Immigration by Place of Birth - Other Central Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Northern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Algeria",
            "2021 Household Population for Total Immigration by Place of Birth - Egypt",
            "2021 Household Population for Total Immigration by Place of Birth - Morocco",
            "2021 Household Population for Total Immigration by Place of Birth - Tunisia",
            "2021 Household Population for Total Immigration by Place of Birth - Other Northern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - South Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Asia",
            "2021 Household Population for Total Immigration by Place of Birth - West Central Asia and Middle East",
            "2021 Household Population for Total Immigration by Place of Birth - Afghanistan",
            "2021 Household Population for Total Immigration by Place of Birth - Iran",
            "2021 Household Population for Total Immigration by Place of Birth - Iraq",
            "2021 Household Population for Total Immigration by Place of Birth - Israel",
            "2021 Household Population for Total Immigration by Place of Birth - Lebanon",
            "2021 Household Population for Total Immigration by Place of Birth - Saudi Arabia",
            "2021 Household Population for Total Immigration by Place of Birth - Syria",
            "2021 Household Population for Total Immigration by Place of Birth - Turkey",
            "2021 Household Population for Total Immigration by Place of Birth - United Arab Emirates",
            "2021 Household Population for Total Immigration by Place of Birth - Other West Central Asia and Middle East",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - China",
            "2021 Household Population for Total Immigration by Place of Birth - Hong Kong",
            "2021 Household Population for Total Immigration by Place of Birth - Japan",
            "2021 Household Population for Total Immigration by Place of Birth - South Korea",
            "2021 Household Population for Total Immigration by Place of Birth - Taiwan",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Southeastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Cambodia",
            "2021 Household Population for Total Immigration by Place of Birth - Malaysia",
            "2021 Household Population for Total Immigration by Place of Birth - Philippines",
            "2021 Household Population for Total Immigration by Place of Birth - Vietnam",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southeastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Bangladesh",
            "2021 Household Population for Total Immigration by Place of Birth - India",
            "2021 Household Population for Total Immigration by Place of Birth - Nepal",
            "2021 Household Population for Total Immigration by Place of Birth - Pakistan",
            "2021 Household Population for Total Immigration by Place of Birth - Sri Lanka",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Oceania and Other",
            "2021 Household Population for Total Immigration by Place of Birth - Australia",
            "2021 Household Population for Total Immigration by Place of Birth - Fiji",
            "2021 Household Population for Total Immigration by Place of Birth - Other Oceania and Other",
            "2021 Household Population for Total Immigration by Place of Birth - Non-permanent residents",
        ]
    )

    return mock_pdf_demographics_data_10_min_data


@pytest.fixture(scope="session")
def mock_pdf_demographics_data_15_min():
    mock_pdf_demographics_data_15_min_data = spark.sparkContext.parallelize(
        [
            Row(
                "1001160",
                "Sobeys Grimsby                ",
                "642",
                "68595",
                "19809",
                "37852",
                "68595",
                "3814",
                "4089",
                "4126",
                "4000",
                "3931",
                "3948",
                "4172",
                "4819",
                "4533",
                "4433",
                "4593",
                "4962",
                "4553",
                "3944",
                "3398",
                "2306",
                "1478",
                "1495",
                "41.338",
                "25374",
                "2.667",
                "22150",
                "0.873",
                "461",
                "2672",
                "2771",
                "2884",
                "2836",
                "13751",
                "3208",
                "2793",
                "3529",
                "4221",
                "2818",
                "1403",
                "127555.571",
                "107958.176",
                "55703",
                "7311",
                "15792",
                "3842",
                "14357",
                "745",
                "13656",
                "9755",
                "3901",
                "67731",
                "7393",
                "603",
                "3042",
                "1129",
                "252",
                "480",
                "347",
                "331",
                "203",
                "225",
                "157",
                "326",
                "299",
                "60338",
                "67731",
                "55562",
                "50898",
                "4664",
                "11812",
                "1477",
                "544",
                "541",
                "3",
                "99",
                "25",
                "51",
                "23",
                "445",
                "34",
                "4",
                "202",
                "127",
                "78",
                "390",
                "26",
                "19",
                "87",
                "111",
                "40",
                "23",
                "85",
                "7268",
                "1413",
                "19",
                "371",
                "926",
                "97",
                "1328",
                "57",
                "70",
                "18",
                "786",
                "136",
                "95",
                "97",
                "69",
                "2222",
                "2019",
                "99",
                "105",
                "2304",
                "83",
                "843",
                "270",
                "269",
                "451",
                "188",
                "200",
                "355",
                "53",
                "1",
                "34",
                "11",
                "7",
                "111",
                "5",
                "0",
                "27",
                "3",
                "10",
                "66",
                "20",
                "0",
                "12",
                "7",
                "69",
                "3",
                "38",
                "9",
                "0",
                "19",
                "102",
                "97",
                "5",
                "2636",
                "366",
                "36",
                "40",
                "114",
                "14",
                "38",
                "26",
                "18",
                "25",
                "6",
                "50",
                "397",
                "188",
                "41",
                "32",
                "121",
                "14",
                "1",
                "482",
                "29",
                "19",
                "212",
                "110",
                "112",
                "1390",
                "13",
                "1179",
                "2",
                "164",
                "32",
                "0",
                "76",
                "50",
                "6",
                "20",
                "358",
            ),
            Row(
                "1001954",
                "Sobeys Cambridge              ",
                "678",
                "107272",
                "29460",
                "59372",
                "107272",
                "5610",
                "5958",
                "6101",
                "6244",
                "7034",
                "8246",
                "7738",
                "7427",
                "7010",
                "6807",
                "7009",
                "7524",
                "6818",
                "5667",
                "4555",
                "3213",
                "2185",
                "2127",
                "40.445",
                "40582",
                "2.608",
                "34313",
                "0.846",
                "1693",
                "6759",
                "5757",
                "5284",
                "4702",
                "16388",
                "4743",
                "3579",
                "3937",
                "4129",
                "2704",
                "1424",
                "103622.886",
                "83207.354",
                "88075",
                "17310",
                "28415",
                "6073",
                "20796",
                "1024",
                "14456",
                "10566",
                "3890",
                "105735",
                "17892",
                "1480",
                "6867",
                "3223",
                "1004",
                "1372",
                "1035",
                "1082",
                "410",
                "190",
                "85",
                "707",
                "437",
                "87843",
                "105735",
                "83120",
                "72739",
                "10381",
                "21781",
                "2830",
                "546",
                "546",
                "0",
                "615",
                "343",
                "153",
                "119",
                "797",
                "46",
                "16",
                "346",
                "129",
                "261",
                "872",
                "145",
                "34",
                "192",
                "397",
                "0",
                "29",
                "74",
                "11039",
                "960",
                "71",
                "400",
                "326",
                "163",
                "1466",
                "130",
                "148",
                "14",
                "486",
                "418",
                "83",
                "58",
                "131",
                "3285",
                "3098",
                "98",
                "89",
                "5328",
                "103",
                "400",
                "4312",
                "56",
                "124",
                "215",
                "118",
                "804",
                "95",
                "1",
                "9",
                "72",
                "13",
                "341",
                "53",
                "56",
                "33",
                "20",
                "36",
                "142",
                "50",
                "0",
                "4",
                "45",
                "207",
                "30",
                "125",
                "11",
                "0",
                "41",
                "112",
                "109",
                "3",
                "7046",
                "1302",
                "169",
                "91",
                "352",
                "5",
                "197",
                "18",
                "181",
                "51",
                "36",
                "201",
                "738",
                "482",
                "135",
                "12",
                "98",
                "12",
                "0",
                "1662",
                "19",
                "17",
                "820",
                "553",
                "252",
                "3344",
                "74",
                "1848",
                "25",
                "1262",
                "131",
                "3",
                "61",
                "39",
                "0",
                "22",
                "833",
            ),
            Row(
                "1003570",
                "Sobeys Simcoe                 ",
                "664",
                "31675",
                "9086",
                "15110",
                "31675",
                "1346",
                "1470",
                "1414",
                "1487",
                "1603",
                "1727",
                "1855",
                "1781",
                "1580",
                "1713",
                "2004",
                "2509",
                "2747",
                "2653",
                "2198",
                "1610",
                "1039",
                "941",
                "46.443",
                "13388",
                "2.292",
                "7788",
                "0.582",
                "492",
                "2635",
                "2106",
                "1820",
                "1584",
                "4751",
                "1497",
                "1119",
                "1101",
                "1034",
                "744",
                "290",
                "93322.518",
                "75827.304",
                "26445",
                "4740",
                "8421",
                "2240",
                "7016",
                "313",
                "3714",
                "2729",
                "985",
                "30669",
                "902",
                "120",
                "95",
                "407",
                "97",
                "37",
                "32",
                "19",
                "11",
                "33",
                "0",
                "25",
                "25",
                "29768",
                "30669",
                "27695",
                "25690",
                "2005",
                "2841",
                "478",
                "193",
                "189",
                "4",
                "91",
                "8",
                "78",
                "5",
                "148",
                "0",
                "3",
                "76",
                "16",
                "53",
                "46",
                "10",
                "0",
                "18",
                "6",
                "0",
                "0",
                "12",
                "1992",
                "541",
                "8",
                "161",
                "263",
                "108",
                "208",
                "12",
                "64",
                "1",
                "66",
                "16",
                "15",
                "17",
                "17",
                "748",
                "689",
                "3",
                "56",
                "495",
                "20",
                "56",
                "341",
                "1",
                "33",
                "14",
                "30",
                "87",
                "4",
                "0",
                "0",
                "0",
                "4",
                "27",
                "0",
                "1",
                "0",
                "0",
                "0",
                "26",
                "41",
                "0",
                "0",
                "41",
                "2",
                "0",
                "2",
                "0",
                "0",
                "0",
                "13",
                "13",
                "0",
                "268",
                "32",
                "5",
                "9",
                "0",
                "6",
                "0",
                "2",
                "0",
                "0",
                "1",
                "9",
                "82",
                "56",
                "3",
                "1",
                "23",
                "0",
                "0",
                "119",
                "0",
                "7",
                "100",
                "10",
                "3",
                "34",
                "0",
                "25",
                "0",
                "8",
                "1",
                "0",
                "17",
                "10",
                "0",
                "7",
                "133",
            ),
            Row(
                "1005168",
                "Sobeys Highway 400 Barrie     ",
                "712",
                "127104",
                "32992",
                "71195",
                "127104",
                "6659",
                "7082",
                "7517",
                "7813",
                "8889",
                "9581",
                "9522",
                "8973",
                "8387",
                "8580",
                "8500",
                "9117",
                "7500",
                "5755",
                "4880",
                "3515",
                "2376",
                "2458",
                "39.673",
                "46125",
                "2.712",
                "39302",
                "0.852",
                "1512",
                "7242",
                "6218",
                "5832",
                "5424",
                "19898",
                "5550",
                "4389",
                "4943",
                "5016",
                "3584",
                "1432",
                "105933.543",
                "88059.094",
                "103557",
                "16142",
                "32893",
                "6589",
                "28302",
                "1121",
                "18510",
                "14023",
                "4487",
                "124793",
                "14711",
                "1475",
                "3259",
                "4279",
                "1188",
                "1649",
                "622",
                "350",
                "338",
                "368",
                "206",
                "474",
                "504",
                "110082",
                "124793",
                "108412",
                "96975",
                "11437",
                "15562",
                "2895",
                "672",
                "667",
                "5",
                "298",
                "110",
                "87",
                "102",
                "1032",
                "52",
                "28",
                "522",
                "231",
                "199",
                "892",
                "173",
                "51",
                "131",
                "216",
                "51",
                "9",
                "261",
                "7836",
                "1429",
                "51",
                "593",
                "640",
                "144",
                "1763",
                "123",
                "166",
                "21",
                "739",
                "159",
                "214",
                "156",
                "185",
                "3109",
                "2816",
                "137",
                "156",
                "1536",
                "100",
                "580",
                "496",
                "76",
                "88",
                "47",
                "149",
                "752",
                "136",
                "9",
                "44",
                "83",
                "0",
                "341",
                "2",
                "11",
                "79",
                "5",
                "42",
                "202",
                "61",
                "7",
                "27",
                "28",
                "105",
                "12",
                "70",
                "16",
                "4",
                "4",
                "109",
                "106",
                "3",
                "4021",
                "660",
                "46",
                "184",
                "51",
                "44",
                "72",
                "23",
                "58",
                "35",
                "12",
                "136",
                "971",
                "551",
                "70",
                "43",
                "240",
                "55",
                "12",
                "1194",
                "64",
                "34",
                "813",
                "196",
                "86",
                "1196",
                "85",
                "528",
                "19",
                "436",
                "127",
                "0",
                "58",
                "26",
                "4",
                "28",
                "820",
            ),
            Row(
                "1009301",
                "Sobeys Bridgeport             ",
                "649",
                "267015",
                "69472",
                "148779",
                "267015",
                "12450",
                "12684",
                "12880",
                "14448",
                "23783",
                "26580",
                "21640",
                "18124",
                "15895",
                "15613",
                "16241",
                "17651",
                "15926",
                "13153",
                "10892",
                "7772",
                "5471",
                "5811",
                "40.139",
                "110011",
                "2.394",
                "74853",
                "0.68",
                "5781",
                "20848",
                "16665",
                "14107",
                "11809",
                "40801",
                "11251",
                "8407",
                "9380",
                "11762",
                "7279",
                "4484",
                "101253.559",
                "76353.117",
                "225146",
                "32608",
                "62672",
                "12194",
                "44331",
                "2802",
                "70539",
                "45888",
                "24651",
                "263125",
                "68095",
                "14352",
                "15532",
                "10422",
                "1610",
                "5352",
                "4348",
                "6221",
                "3397",
                "1752",
                "416",
                "2322",
                "2373",
                "195030",
                "263125",
                "188203",
                "168574",
                "19629",
                "64542",
                "8924",
                "2341",
                "2332",
                "9",
                "2100",
                "961",
                "451",
                "688",
                "1807",
                "209",
                "23",
                "842",
                "351",
                "382",
                "2676",
                "315",
                "105",
                "866",
                "989",
                "95",
                "90",
                "214",
                "23138",
                "4222",
                "216",
                "2784",
                "720",
                "502",
                "7440",
                "337",
                "435",
                "64",
                "2292",
                "2463",
                "572",
                "590",
                "686",
                "4556",
                "4115",
                "238",
                "202",
                "6921",
                "265",
                "394",
                "1051",
                "1982",
                "1061",
                "1482",
                "685",
                "5711",
                "516",
                "21",
                "102",
                "253",
                "139",
                "3462",
                "1194",
                "665",
                "257",
                "572",
                "90",
                "683",
                "129",
                "13",
                "96",
                "20",
                "1322",
                "19",
                "785",
                "19",
                "30",
                "469",
                "282",
                "271",
                "11",
                "26580",
                "7548",
                "793",
                "1126",
                "1564",
                "149",
                "300",
                "209",
                "1638",
                "501",
                "111",
                "1158",
                "7058",
                "4987",
                "576",
                "117",
                "1002",
                "370",
                "7",
                "4475",
                "88",
                "94",
                "1392",
                "1627",
                "1274",
                "7497",
                "552",
                "4464",
                "178",
                "1647",
                "533",
                "123",
                "189",
                "98",
                "1",
                "90",
                "10380",
            ),
        ]
    ).toDF(
        [
            "Banner Key",
            "BAN_NAME",
            "BAN_NO",
            "2021 Total Population3",
            "2021 Total Census Family Households",
            "2021 In The Labour Force",
            "2021 Total Population6",
            "2021 Total Population 0 to 4",
            "2021 Total Population 5 to 9",
            "2021 Total Population 10 to 14",
            "2021 Total Population 15 to 19",
            "2021 Total Population 20 to 24",
            "2021 Total Population 25 to 29",
            "2021 Total Population 30 to 34",
            "2021 Total Population 35 to 39",
            "2021 Total Population 40 to 44",
            "2021 Total Population 45 to 49",
            "2021 Total Population 50 to 54",
            "2021 Total Population 55 to 59",
            "2021 Total Population 60 to 64",
            "2021 Total Population 65 to 69",
            "2021 Total Population 70 to 74",
            "2021 Total Population 75 to 79",
            "2021 Total Population 80 to 84",
            "2021 Total Population 85 or Older",
            "2021 Average Age of Total Population",
            "2021 Total Households for Household Size",
            "2021 Household Size - Average Number of Persons In Private Households",
            "2021 Total Number of Children at Home",
            "2021 Average Children Per Household",
            "2021 Household Income $0 To $19,999 (Current Year $)",
            "2021 Household Income $20,000 To $39,999 (Current Year $)",
            "2021 Household Income $40,000 To $59,999 (Current Year $)",
            "2021 Household Income $60,000 To $79,999 (Current Year $)",
            "2021 Household Income $80,000 To $99,999 (Current Year $)",
            "2021 Household Income $100,000 Or Over (Current Year $)",
            "2021 Household Income $100,000 To $124,999 (Current Year $)",
            "2021 Household Income $125,000 To $149,999 (Current Year $)",
            "2021 Household Income $150,000 To $199,999 (Current Year $)",
            "2021 Household Income $200,000 Or Over (Current Year $)",
            "2021 Household Income $200,000 To $299,999 (Current Year $)",
            "2021 Household Income $300,000 Or Over (Current Year $)",
            "2021 Average Household Income (Current Year $)",
            "2021 Median Household Income (Current Year $)",
            "2021 Household Population 15 Years or Over for Educational Attainment",
            "2021 Household Population 15 Years or Over for Educational Attainment - No certificate, diploma or degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - High school certificate or equivalent",
            "2021 Household Population 15 Years or Over for Educational Attainment - Apprenticeship or trades certificate or diploma",
            "2021 Household Population 15 Years or Over for Educational Attainment - College, CEGEP or other non-university certificate or diploma",
            "2021 Household Population 15 Years or Over for Educational Attainment - University certificate or diploma below bachelor",
            "2021 Household Population 15 Years or Over for Educational Attainment - University degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - Bachelors degree",
            "2021 Household Population 15 Years or Over for Educational Attainment - Above Bachelors",
            "2021 Household Population For Visible Minority",
            "2021 Total Visible Minorities",
            "2021 Total Visible Minorities - Chinese",
            "2021 Total Visible Minorities - South Asian",
            "2021 Total Visible Minorities - Black",
            "2021 Total Visible Minorities - Filipino",
            "2021 Total Visible Minorities - Latin American",
            "2021 Total Visible Minorities - Southeast Asian",
            "2021 Total Visible Minorities - Arab",
            "2021 Total Visible Minorities - West Asian",
            "2021 Total Visible Minorities - Korean",
            "2021 Total Visible Minorities - Japanese",
            "2021 All Other Visible Minorities",
            "2021 Multiple Visible Minorities",
            "2021 Not a Visible Minority",
            "2021 Household Population for Total Immigration by Place of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant in Province of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Non-Immigrant outside Province of Birth",
            "2021 Household Population for Total Immigration by Place of Birth - Total Immigrant",
            "2021 Household Population for Total Immigration by Place of Birth - Americas",
            "2021 Household Population for Total Immigration by Place of Birth - North America",
            "2021 Household Population for Total Immigration by Place of Birth - United States",
            "2021 Household Population for Total Immigration by Place of Birth - Other North America",
            "2021 Household Population for Total Immigration by Place of Birth - Central America",
            "2021 Household Population for Total Immigration by Place of Birth - El Salvador",
            "2021 Household Population for Total Immigration by Place of Birth - Mexico",
            "2021 Household Population for Total Immigration by Place of Birth - Other Central America",
            "2021 Household Population for Total Immigration by Place of Birth - Caribbean and Bermuda",
            "2021 Household Population for Total Immigration by Place of Birth - Cuba",
            "2021 Household Population for Total Immigration by Place of Birth - Haiti",
            "2021 Household Population for Total Immigration by Place of Birth - Jamaica",
            "2021 Household Population for Total Immigration by Place of Birth - Trinidad and Tobago",
            "2021 Household Population for Total Immigration by Place of Birth - Other Caribbean and Bermuda",
            "2021 Household Population for Total Immigration by Place of Birth - South America",
            "2021 Household Population for Total Immigration by Place of Birth - Brazil",
            "2021 Household Population for Total Immigration by Place of Birth - Chile",
            "2021 Household Population for Total Immigration by Place of Birth - Colombia",
            "2021 Household Population for Total Immigration by Place of Birth - Guyana",
            "2021 Household Population for Total Immigration by Place of Birth - Peru",
            "2021 Household Population for Total Immigration by Place of Birth - Venezuela",
            "2021 Household Population for Total Immigration by Place of Birth - Other South America",
            "2021 Household Population for Total Immigration by Place of Birth - Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Western Europe",
            "2021 Household Population for Total Immigration by Place of Birth - France",
            "2021 Household Population for Total Immigration by Place of Birth - Germany",
            "2021 Household Population for Total Immigration by Place of Birth - Netherlands",
            "2021 Household Population for Total Immigration by Place of Birth - Other Western Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Czech Republic",
            "2021 Household Population for Total Immigration by Place of Birth - Hungary",
            "2021 Household Population for Total Immigration by Place of Birth - Moldova",
            "2021 Household Population for Total Immigration by Place of Birth - Poland",
            "2021 Household Population for Total Immigration by Place of Birth - Romania",
            "2021 Household Population for Total Immigration by Place of Birth - Russia",
            "2021 Household Population for Total Immigration by Place of Birth - Ukraine",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Northern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - United Kingdom",
            "2021 Household Population for Total Immigration by Place of Birth - Ireland",
            "2021 Household Population for Total Immigration by Place of Birth - Other Northern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Greece",
            "2021 Household Population for Total Immigration by Place of Birth - Italy",
            "2021 Household Population for Total Immigration by Place of Birth - Portugal",
            "2021 Household Population for Total Immigration by Place of Birth - Bosnia Herzegovina",
            "2021 Household Population for Total Immigration by Place of Birth - Croatia",
            "2021 Household Population for Total Immigration by Place of Birth - Serbia",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Europe",
            "2021 Household Population for Total Immigration by Place of Birth - Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Western Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Cï¿½te dIvoire",
            "2021 Household Population for Total Immigration by Place of Birth - Ghana",
            "2021 Household Population for Total Immigration by Place of Birth - Nigeria",
            "2021 Household Population for Total Immigration by Place of Birth - Other Western Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Eritrea",
            "2021 Household Population for Total Immigration by Place of Birth - Ethiopia",
            "2021 Household Population for Total Immigration by Place of Birth - Kenya",
            "2021 Household Population for Total Immigration by Place of Birth - Somalia",
            "2021 Household Population for Total Immigration by Place of Birth - Tanzania",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Central Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Cameroon",
            "2021 Household Population for Total Immigration by Place of Birth - Congo, The Democratic Republic of The",
            "2021 Household Population for Total Immigration by Place of Birth - Other Central Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Northern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Algeria",
            "2021 Household Population for Total Immigration by Place of Birth - Egypt",
            "2021 Household Population for Total Immigration by Place of Birth - Morocco",
            "2021 Household Population for Total Immigration by Place of Birth - Tunisia",
            "2021 Household Population for Total Immigration by Place of Birth - Other Northern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - South Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Africa",
            "2021 Household Population for Total Immigration by Place of Birth - Asia",
            "2021 Household Population for Total Immigration by Place of Birth - West Central Asia and Middle East",
            "2021 Household Population for Total Immigration by Place of Birth - Afghanistan",
            "2021 Household Population for Total Immigration by Place of Birth - Iran",
            "2021 Household Population for Total Immigration by Place of Birth - Iraq",
            "2021 Household Population for Total Immigration by Place of Birth - Israel",
            "2021 Household Population for Total Immigration by Place of Birth - Lebanon",
            "2021 Household Population for Total Immigration by Place of Birth - Saudi Arabia",
            "2021 Household Population for Total Immigration by Place of Birth - Syria",
            "2021 Household Population for Total Immigration by Place of Birth - Turkey",
            "2021 Household Population for Total Immigration by Place of Birth - United Arab Emirates",
            "2021 Household Population for Total Immigration by Place of Birth - Other West Central Asia and Middle East",
            "2021 Household Population for Total Immigration by Place of Birth - Eastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - China",
            "2021 Household Population for Total Immigration by Place of Birth - Hong Kong",
            "2021 Household Population for Total Immigration by Place of Birth - Japan",
            "2021 Household Population for Total Immigration by Place of Birth - South Korea",
            "2021 Household Population for Total Immigration by Place of Birth - Taiwan",
            "2021 Household Population for Total Immigration by Place of Birth - Other Eastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Southeastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Cambodia",
            "2021 Household Population for Total Immigration by Place of Birth - Malaysia",
            "2021 Household Population for Total Immigration by Place of Birth - Philippines",
            "2021 Household Population for Total Immigration by Place of Birth - Vietnam",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southeastern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Southern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Bangladesh",
            "2021 Household Population for Total Immigration by Place of Birth - India",
            "2021 Household Population for Total Immigration by Place of Birth - Nepal",
            "2021 Household Population for Total Immigration by Place of Birth - Pakistan",
            "2021 Household Population for Total Immigration by Place of Birth - Sri Lanka",
            "2021 Household Population for Total Immigration by Place of Birth - Other Southern Asia",
            "2021 Household Population for Total Immigration by Place of Birth - Oceania and Other",
            "2021 Household Population for Total Immigration by Place of Birth - Australia",
            "2021 Household Population for Total Immigration by Place of Birth - Fiji",
            "2021 Household Population for Total Immigration by Place of Birth - Other Oceania and Other",
            "2021 Household Population for Total Immigration by Place of Birth - Non-permanent residents",
        ]
    )

    return mock_pdf_demographics_data_15_min_data


@pytest.fixture(scope="session")
def mock_competitor():
    mock_competitor_data = spark.createDataFrame(
        [
            Row(
                Drive_Time="5min",
                COMP_BANNER_KEY="1011700",
                COMP_PARENT_CO="COSTCO CANADA",
                COMP_BANNER_FORMAT="Discount Service",
                COMP_BAN_TYPE="COSC",
                BK="1023559",
            ),
            Row(
                Drive_Time="15min",
                COMP_BANNER_KEY="1018206",
                COMP_PARENT_CO="COSTCO CANADA",
                COMP_BANNER_FORMAT="Community Service",
                COMP_BAN_TYPE="COSC",
                BK="1011619",
            ),
            Row(
                Drive_Time="10min",
                COMP_BANNER_KEY="1020586",
                COMP_PARENT_CO="METRO INC",
                COMP_BANNER_FORMAT="Discount       ",
                COMP_BAN_TYPE="FB",
                BK="1023559",
            ),
            Row(
                Drive_Time="15min",
                COMP_BANNER_KEY="1018930",
                COMP_PARENT_CO="LOBLAW",
                COMP_BANNER_FORMAT="Full Service   ",
                COMP_BAN_TYPE="FOR",
                BK="1016225",
            ),
            Row(
                Drive_Time="10min",
                COMP_BANNER_KEY="1021988",
                COMP_PARENT_CO="OTHER",
                COMP_BANNER_FORMAT="Full Service   ",
                COMP_BAN_TYPE="GALLER",
                BK="1023559",
            ),
        ]
    )

    return mock_competitor_data


def test_clean_location(mock_location: SparkDataFrame):
    location_df = clean_location(mock_location)
    location_df = spark.createDataFrame(location_df)

    # checking the record count
    msg = f"count is not matching"
    assert location_df.count() == 5, msg

    # checking the schema
    msg = f"schema is not matching"
    assert set(location_df.columns) == {
        "STORE_NO",
        "RETAIL_OUTLET_LOCATION_SK",
        "POSTAL_CD",
        "STORE_PHYSICAL_LOCATION_NO",
        "REGION_DESC",
        "NATIONAL_BANNER_DESC",
    }, msg


def test_read_format_data_header(mock_pdf_demographics_data_15_min: SparkDataFrame):
    demo_15_min = read_format_data_header(
        mock_pdf_demographics_data_15_min.toPandas(), True, "2021"
    )

    # checking the record count
    msg = f"data contains NA/null value"
    assert demo_15_min.isnull().any(axis=1).sum() == 0, msg

    msg = f"TOTAL_POPULATION is not present"
    assert "2021_TOTAL_POPULATION" in demo_15_min.columns, msg

    # checking the record count
    demo_15_min = spark.createDataFrame(demo_15_min)
    msg = f"count is not matching"
    assert demo_15_min.count() == 5, msg


def test_combine_dataframe(
    mock_pdf_demographics_data_5_min: SparkDataFrame,
    mock_pdf_demographics_data_10_min: SparkDataFrame,
    mock_pdf_demographics_data_15_min: SparkDataFrame,
):
    demo_combine = combine_dataframe(
        mock_pdf_demographics_data_5_min.toPandas(),
        mock_pdf_demographics_data_10_min.toPandas(),
        mock_pdf_demographics_data_15_min.toPandas(),
    )

    # checking the record count
    msg = f"count is not matching"
    assert len(demo_combine) == 3, msg


def test_preprocess_competitors(mock_competitor: SparkDataFrame):
    pdf_competitor_data = read_format_data_header(
        df=mock_competitor.toPandas(),
        isdemographic=False,
        prefix="2021",
    )
    competitor_group = ["DRIVE_TIME", "BK"]
    banner_corrected_key = "1016225"
    banner_corrected_format = "Discount"

    pdf_competitor_processed = preprocess_competitors(
        competitor_data_df=pdf_competitor_data,
        competitor_group=competitor_group,
        banner_corrected_key=banner_corrected_key,
        banner_corrected_format=banner_corrected_format,
    )

    # checking the column count
    msg = f"count is not matching"
    assert len(pdf_competitor_processed.count()) == 40, msg

    # checking the record count
    pdf_competitor_processed = spark.createDataFrame(pdf_competitor_processed)
    msg = f"count is not matching"
    assert pdf_competitor_processed.count() == 3, msg


def test_process_store_data(
    mock_store_list: SparkDataFrame, mock_location: SparkDataFrame
):
    filter_store_corrected = {
        "STORE_NO": "4761",
        "STORE_PHYSICAL_LOCATION_NO": "11429",
        "NATIONAL_BANNER_DESC": "SOBEYS",
        "REGION_DESC": "Ontario",
        "POSTAL_CD": "XXXXXX",
    }

    missing_store = {
        "G0A4J0": "6124",
        "L0K1B0": "3308",
        "L7C1K2": "3303",
        "L0K1E0": "3302",
        "L4M4Y8": "3310",
        "A0K2E0": "9218",
        "N3B2P5": "3301",
        "L0G1M0": "3279",
        "M2J1L8": "3297",
        "L0G1T0": "3276",
        "N4X1A6": "3296",
        "P4N7C3": "3286",
        "N0G2W0": "3263",
        "N4S1E4": "3291",
        "L8L3B4": "3884",
        "L6T3S1": "3857",
        "L2Y2A6": "3859",
        "L1M1T6": "3861",
        "L2H0L4": "3811",
        "L1C3A0": "3871",
        "L1V1A6": "3865",
        "L1C0C7": "3892",
        "L1G4W7": "3870",
        "N2A2Y2": "3882",
        "J9H6H4": "8052",
        "H4C1R1": "8063",
        "J0P1P0": "8071",
        "H3K1P2": "8066",
        "J2W2A3": "8164",
        "J3L4Y3": "6964",
        "J5R1W7": "8031",
        "J5R0B4": "8032",
        "J2W1C7": "8163",
        "J6A2P5": "8058",
        "S0N1H0": "3113",
        "R2V1Y9": "5267",
        "J4Y1A1": "4001",
        "H3S1J1": "4002",
        "H1Z2G1": "4004",
        "H4K2V6": "4005",
        "B4A3Y4": "10061",
        "B3J4B1": "10060",
        "N0P1A0": "4107",
        "N7M1W3": "4116",
        "N2Z3B9": "4108",
        "G0R1H0": "8702",
        "G0J3K0": "8795",
        "A0K1B0": "9282",
        "J3L3R8": "6964",
        "J0J2A0": "8164",
        "N1M2W3": "3862",
        "T8N5J9": "5067",
        "T6J4V9": "8957",
        "L9T3H5": "3863",
        "T0M0J0": "9515",
        "A8A1E6": "9218",
    }

    # Dataset containing ban nos of duplicated stores in same postal code (need to config and refactor)
    duplicated_store = {
        "5621": "5621",
        "886": "886",
        "7267": "7267",
        "66": "66",
        "3011": "3011",
        "609": "609",
        "5118": "5118",
        "7583": "7583",
        "7020": "7020",
        "7506": "7506",
        "818": "818",
        "70019": "70019",
        "70044": "70044",
        "70017": "70017",
        "7265": "7265",
        "70041": "70041",
        "70039": "70039",
        "70038": "70038",
        "70034": "70034",
    }

    ###########################################################################
    # LOAD MISSING STORE DATA
    ###########################################################################

    missing_ban_no = pd.DataFrame(
        missing_store.items(), columns=["POSTAL_CD", "BAN_NO_CORRECTED"]
    )
    update_missing_ban_no = pd.DataFrame(
        duplicated_store.items(), columns=["BAN_NO", "BAN_NO_FINAL"]
    )

    pdf_store_list = read_format_data_header(
        df=mock_store_list.toPandas(),
        isdemographic=False,
        prefix="2021",
    )

    df_location = clean_location(df_loc=mock_location)

    pdf_store_list_processed = process_store_data(
        store_list_df=pdf_store_list,
        location_df=df_location,
        filter_store_corrected=filter_store_corrected,
        missing_ban_no=missing_ban_no,
        update_missing_ban_no=update_missing_ban_no,
    )

    # checking the record count
    pdf_store_list_processed = spark.createDataFrame(pdf_store_list_processed)
    msg = f"count is not matching"
    assert pdf_store_list_processed.count() == 2, msg

    # checking the schema
    msg = f"schema not matching"
    assert set(pdf_store_list_processed.columns) == {
        "index",
        "BANNER_KEY",
        "TOT_WKLY_SALES",
        "TOT_SALES_AREA",
        "TOT_GROSS_AREA",
        "STORE_PHYSICAL_LOCATION_NO",
        "Region_Desc",
        "Banner",
    }, msg


def test_preprocess_demographics(
    mock_pdf_demographics_data_5_min: SparkDataFrame,
    mock_pdf_demographics_data_10_min: SparkDataFrame,
    mock_pdf_demographics_data_15_min: SparkDataFrame,
):
    col_name_prefix = "2021"
    pdf_demographics_data_5_min = read_format_data_header(
        df=mock_pdf_demographics_data_5_min.toPandas(),
        isdemographic=True,
        prefix=col_name_prefix,
    )

    pdf_demographics_data_10_min = read_format_data_header(
        df=mock_pdf_demographics_data_10_min.toPandas(),
        isdemographic=True,
        prefix=col_name_prefix,
    )

    pdf_demographics_data_15_min = read_format_data_header(
        df=mock_pdf_demographics_data_15_min.toPandas(),
        isdemographic=True,
        prefix=col_name_prefix,
    )

    demographic_dfs = combine_dataframe(
        pdf_demographics_data_5_min,
        pdf_demographics_data_10_min,
        pdf_demographics_data_15_min,
    )

    pdf_demographic_processed = preprocess_demographics(
        dfs=demographic_dfs,
        dist_list=["_5", "_10", "_15"],
        col_prefix=col_name_prefix,
        key="BANNER_KEY",
    )

    # checking the column count
    msg = f"count is not matching"
    assert len(pdf_demographic_processed.count()) == 534, msg

    # checking the record count
    pdf_demographic_processed = spark.createDataFrame(pdf_demographic_processed)
    msg = f"count is not matching"
    assert pdf_demographic_processed.count() == 5, msg


def test_final_patch_to_environics_data(
    mock_pdf_demographics_data_15_min: SparkDataFrame,
):
    mock_pdf_demographics_data_15_min = mock_pdf_demographics_data_15_min.withColumn(
        "2021_HOUSEHOLD_POPULATION_FOR_TOTAL_IMMIGRATION_BY_PLACE_OF_BIRTH_5",
        F.lit("ASIA"),
    )

    pdf_demographics_data_15_min = read_format_data_header(
        df=mock_pdf_demographics_data_15_min.toPandas(),
        isdemographic=True,
        prefix="2021",
    )
    final_df = final_patch_to_environics_data(
        spark.createDataFrame(pdf_demographics_data_15_min), "2021"
    )

    # checking for dropped columns
    msg = f"2021_HOUSEHOLD_POPULATION_FOR_TOTAL_IMMIGRATION_BY_PLACE_OF_BIRTH_5 is present"
    assert (
        "2021_HOUSEHOLD_POPULATION_FOR_TOTAL_IMMIGRATION_BY_PLACE_OF_BIRTH_5"
        not in final_df.columns
    ), msg
